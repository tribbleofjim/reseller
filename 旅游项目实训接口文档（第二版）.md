## 旅游项目实训接口文档（初步）

### 公司业务员

**CompanyOperatorController**

**RequestMapping:** /comoper

###### 1.0 查看产品列表

**RequestMapping:** /products 

**RequestMethod:**GET

**RequestParams:**None

**ResponseBody:**

```json
// 正确时
{
    "message":"success",
    "nums":100(这里100是打个比方，指的data列表的长度，也就是一共有几个产品),
    "code":200,
    data:[
        {
            "id":旅游项目id,
            "name":旅游项目名称,
            "companyID":所属公司id,
            "price":价格,
            "info":详细信息,
            "picture":项目图片(可以有，可以没有……),
            "sales":由该业务员分发出去的广告的点击量，也就是他的业绩
        },
        {
            "id":xxx,
            "name":xxx,
            ......
        }
    ]
}
// 错误时，统一都是400错误，message里带有错误信息
{
     "message":"xxxx",
     "code":400,
     "data":{}
}
```



###### 1.1 查看自己名下的分销商

**RequestMapping:** /resellers

**RequestMethod:**GET

**RequestParams:**

```json
{
    "phoneNumber":公司业务员id，也就是电话号码
}
```

**ResponseBody:**

```json
// 正确时
{
    "message":"xxxx",
    "nums":100(这里100是打个比方，指的分销商data列表的长度),
    "code":200,
    data:[
        {
            "id":分销商id,
            "name":分销商名称,
            "phone":分销商电话
        },
        {
            "id":xxx,
            "name":xxx,
            ......
        }
    ]
}
// 错误时，统一都是400错误，message里带有错误信息
{
     "message":"xxxx",
     "code":400,
     "data":{}
}
```



###### 1.2 将产品下发给某个分销商

**RequestMapping:** /distribute

**RequestMethod:**POST

**RequestParams:**

```json
{
    "resId":分销商id,
    "proId":产品id
}
// 这个数据表是role2product
```

**ResponseBody:**

```json
// 正确时
{
    "message":"ok",
    "code":200
}
// 错误时
{
    "message":"error",
    "code":400
}
```



###### 1.3 查看订单

**RequestMapping:** /orders

**RequestMethod:**GET

**RequestParams:**

```json
{
    "id":公司业务员id
}
```

**ResponseBody:**

```json
// 正确时
{
    "message":"ok",
    "nums":100(这里100是打个比方，指的data列表的长度),
    "code":200,
    data:[
        {
            "orderId":订单号,
            "proId":产品id,
            "tourPrice":订单总金额,
            "myPrice":自己这一级在这一单获得的提成,
            "resellerId":分销商id,
            "resOperId":分销商业务员id,
            "travellerId":游客id
        },
        {
            "orderId":订单号,
            "proId":产品id,
            ......
        }
    ]
}
// 错误时，统一都是400错误，message里带有错误信息
{
     "message":"xxxx",
     "code":400,
     "data":{}
}
```



###### 1.4 查看总的提成

**RequestMapping:** /percentage

**RequestMethod:**GET

**RequestParams:**

```json
{
    "id":公司业务员id
}
```

**ResponseBody:**

```json
{
    "percentage": 100 (假设的金额)
}
```



### 分销商

**ResellerController**

**RequestMapping:** /reseller

###### 2.0 查看产品列表

**RequestMapping:** /products 

**RequestMethod:**GET

**RequestParams:**None

**ResponseBody:**

```json
// 正确时
{
    "message":"ok",
    "nums":100(这里100是打个比方，指的data列表的长度，也就是一共有几个产品),
    "code":200,
    data:[
        {
            "id":旅游项目id,
            "name":旅游项目名称,
            "companyId":所属公司id,
            "cost":价格,
            "info":详细信息,
            "pic":项目图片(可以有，可以没有……)
        },
        {
            "id":xxx,
            "name":xxx,
            ......
        }
    ]
}
// 错误时，统一都是400错误，message里带有错误信息
{
     "message":"xxxx",
     "code":400,
     "data":{}
}
```



###### 2.1 查看自己名下的分销商业务员

**RequestMapping:** /operators

**RequestMethod:**GET

**RequestParams:**

```json
{
    "id":分销商id
}
```

**ResponseBody:**

```json
// 正确时
{
    "message":"ok",
    "nums":100(这里100是打个比方，指的分销商data列表的长度),
    "code":200,
    data:[
        {
            "id":分销商业务员id,
            "name":分销商业务员名称,
            "phone":分销商业务员电话
        },
        {
            "id":xxx,
            "name":xxx,
            ......
        }
    ]
}
// 错误时，统一都是400错误，message里带有错误信息
{
     "message":"xxxx",
     "code":400,
     "data":{}
}
```



###### 2.2 下发产品给分销商业务员

**RequestMapping:** /distribute

**RequestMethod:**POST

**RequestParams:**

```json
{
    "resId":分销商业务员id,
    "proId":产品id
}
// 这里我们还需要一个用户角色-产品的关联表
```

**ResponseBody:**

```json
// 正确时
{
    "message":"ok",
    "code":200
}
// 错误时
{
    "message":"error",
    "code":400
}
```

###### 2.3 查看订单

**RequestMapping:** /orders

**RequestMethod:**GET

**RequestParams:**

```json
{
    "id":分销商id
}
```

**ResponseBody:**

```json
// 正确时
{
    "message":"ok",
    "nums":100(这里100是打个比方，指的data列表的长度),
    "code":200,
    data:[
        {
            "orderId":订单号,
            "proId":产品id,
            "tourPrice":订单总金额,
            "myPrice":自己这一级在这一单获得的提成,
            "comOperId":公司业务员id,
            "resOperId":分销商业务员id,
            "travellerId":游客id
        },
        {
            "orderId":订单号,
            "proId":产品id,
            ......
        }
    ]
}
// 错误时，统一都是400错误，message里带有错误信息
{
     "message":"xxxx",
     "code":400,
     "data":{}
}
```



###### 2.4 查看总的提成

**RequestMapping:** /percentage

**RequestMethod:**GET

**RequestParams:**

```json
{
    "id":分销商id
}
```

**ResponseBody:**

```json
{
    "percentage": 100 (假设的金额)
}
```



- 

### 分销商业务员

**OperatorController**

**RequestMapping: /oper**

###### 3.1 查看自己经手的订单和每一单的提成

**RequestMapping:** /orders

**RequestMethod:**GET

**RequestParams:**

```json
{
    "id":分销商id
}
```

**ResponseBody:**

（这里我们还需要一个订单表）

```json
// 正确时
{
    "message":"ok",
    "nums":100(这里100是打个比方，指的data列表的长度),
    "code":200,
    data:[
        {
            "orderId":订单号,
            "proId":产品id,
            "tourPrice":订单总金额,
            "mycost":自己这一级在这一单获得的提成,
            "comOperId":公司业务员id,
            "resellerId:分销商id,
            "travellerId":游客id
        },
        {
            "orderId":订单号,
            "proId":产品id,
            ......
        }
    ]
}
// 错误时，统一都是400错误，message里带有错误信息
{
     "message":"xxxx",
     "code":400,
     "data":{}
}
```



###### 3.2 查看总的提成

**RequestMapping:** /percentage

**RequestMethod:**GET

**RequestParams:**

```json
{
    "id":分销商业务员id
}
```

**ResponseBody:**

```json
{
    "percentage": 100 (假设的金额)
}
```



### 游客

**TravellerController**

**RequestMapping: /traveller**



###### 4.1 下单购买产品

**RequestMapping:** /createorder

**RequestMethod:**POST

**RequestParams:**

```json
{
    "travellerId": 游客id,
    "phone": 游客电话,
    "proId": 产品id,
    "cost": 产品金额，也就是游客最终付的钱
}
```

**ResponseBody:**

```json
// 正确时
{
    "message":"ok",
    "code":200
}
// 错误时
{
    "message":"error",
    "code":400
}
```



###### 4.2 查看可选的分销商业务员列表

**RequestMapping:** /operators

**RequestMethod:**GET

**RequestParams:**None

**ResponseBody:**

```json
// 正确时
{
    "message":"ok",
    "nums":100(这里100是打个比方，指的分销商data列表的长度),
    "code":200,
    data:[
        {
            "id":分销商业务员id,
            "name":分销商业务员名称,
            "phone":分销商业务员电话
        },
        {
            "id":xxx,
            "name":xxx,
            ......
        }
    ]
}
// 错误时，统一都是400错误，message里带有错误信息
{
     "message":"xxxx",
     "code":400,
     "data":{}
}
```



###### 4.3 选择分销商业务员

**RequestMapping:** /chooseoperator

**RequestMethod:**GET

**RequestParams:**

```json
{
    "orderId": 订单号,
    "operId": 这一单所选择的分销商业务员id
}
```

**ResponseBody:**

```json
// 正确时
{
    "message":"ok",
    "code":200
}
// 错误时
{
    "message":"error",
    "code":400
}
```



###### 4.4 查看已购产品

**RequestMapping:** /myproducts

**RequestMethod:**GET

**RequestParams:**

```json
{
    "id": 游客id
}
```

**ResponseBody:**

```json
// 正确时
{
    "message":"ok",
    "nums":100(这里100是打个比方，指的data列表的长度，也就是一共有几个产品),
    "code":200,
    data:[
        {
            "id":旅游项目id,
            "name":旅游项目名称,
            "companyId":所属公司id,
            "tourPrice":价格,
            "info":详细信息,
            "pic":项目图片(还是有吧，可以生成海报的时候用)
        },
        {
            "id":xxx,
            "name":xxx,
            ......
        }
    ]
}
// 错误时，统一都是400错误，message里带有错误信息
{
     "message":"xxxx",
     "code":400,
     "data":{}
}
```



### 公用：所有用户角色

**UserController**

**RequestMapping: /user**



###### 5.1 登录

**RequestMapping:** /webLogin

**RequestMethod:**GET(后期要给密码加密)

**RequestParams:**

```json
{
    "phonenumber": 电话号码,
    "password": 密码
}
```

**ResponseBody:**

```json
// 正确时
{
    "message":"class_x_success"(x是12345中的一个，分别用来指代公司、
                               一级业务员、分销商、二级业务员和游客),
    "code":201/202/203/204/205(分别代表公司、一级业务员、分销商、二级业务员、游客)
}
// 错误时
{
    "message":"xxxx"（错误信息）,
    "code":400
}
```



###### 5.2 注册

**RequestMapping:** /webRegister

**RequestMethod:**POST

**RequestParams:**

```json
{
    "loginName": 用户名,
    "password": 密码,
    "phoneNumber": 电话号码,
    "qqNumber": QQ号,
    "age": 年龄,
    "city": 城市,
    "role": 角色
}
```

**ResponseBody:**

```json
// 正确时
{
    "message":"class_x_success"(x是12345中的一个，分别用来指代公司、
                               一级业务员、分销商、二级业务员和游客),
    "code":200
}
// 错误时
{
    "message":"xxxxx"（具体的错误信息）,
    "code":600(这种情况是注册信息有错误，比如电话号码不合法)/400(这种情况是上传了空表单)
}
```



###### 5.3 生成广告

**RequestMapping:** /generateads

**RequestMethod:**POST

**RequestParams:**

```json
{
    "userId": 角色id(可以是公司业务员、分销商业务员、分销商),
    "proId": 产品id
}
```

**ResponseBody:**

```json
// 正确时
{
    "message":"ok",
    "code":200
}
// 错误时
{
    "message":"error",
    "code":400
}
```



###### 5.4 角色升级（注册成为上一级的角色）

**RequestMapping:** /opratorRegister

**RequestMethod:**POST

**RequestParams:**

```json
{
    "loginName": 用户名,
    "password": 密码,
    "role": 需要注册成为的角色（比如说分销商，这里注意一下role就是字符串"分销商"而不是用数字指代的角色）
}
```

**ResponseBody:**

```json
// 正确时
{
    "message":"ok",
    "code":200
}
// 错误时
{
    "message":"error",
    "code":400
}
```



### 广告

**AdsController**

**RequestMapping:** /ads



###### 6.1 展示产品购买页

**RequestMapping:** /buypage

**RequestMethod:**POST

**RequestParams:**

```json
{
    "userId": 广告来源者的id，这里的来源者可以是公司业务员、分销商业务员或是分销商，不能是游客！！！,
    "proId": 产品id
}
```

**ResponseBody:**

```json
// 正确时
{
    "message":"ok",
    "code":200
}
// 错误时
{
    "message":"error",
    "code":400
}
```

链接到产品详情页，可以点击购买（这里就调的是游客里面下单购买产品的那个接口）



### 其他注意事项：

1. **写给前端的名词解释：**

   **RequestMethod**：用来指明前端发送给后台的请求的方法，有GET和POST两种。这两种请求发送的时候前端代码是不同的，注意一下。后台也需要在方法前面注解声明POST（GET不用）

   **RequestParam**：前端需要传给后台的参数，以键值对的形式

   **ResponseBody**：后台返回给前端的参数，同样是键值对的形式

   **RequestMapping:** 接口的url，需要注意：最终的url是controller的Mapping加上具体方法的mapping，比如说登录，需要找到它的controller是Usercontroller，它的mapping是/user，然后具体登录方法的mapping是/login，那么再加上前缀，最终的url就是http://144.34.188.164:8080/user/login。参数的话可以上网搜一下，需要写成类似文档里那样的json形式。

   

2. 从产品生成海报，海报需要有几个元素：产品图片、产品详情（也就是文字）、购买二维码。这里我想的是，网上有那种生成链接到网页的二维码的接口，我们可以在前端写一个报名的表单页，每次生成海报就生成这个表单页的url的二维码，然后在url里带上广告是来自哪一级的这个信息。如果是有分销商业务员的就不用选择分销商业务员，没有的话就需要调用那个选择的接口。

   这是初步想法，大家有别的想法可以交流。

   

